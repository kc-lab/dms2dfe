# many thanks to 
# https://github.com/jakevdp/travis-python-template
# https://github.com/uwescience/shablona

language: python
cache: pip
sudo: false

env:
  global:
    - PACKAGENAME="dms2dfe"
    - MINICONDA_URL="https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh"

python:
  - '2.7'
  
before_install:
- export MINICONDA=$HOME/miniconda
- export PATH="$MINICONDA/bin:$PATH"
- hash -r
- echo $MINICONDA_URL
- wget $MINICONDA_URL -O miniconda.sh;
- bash miniconda.sh -b -f -p $MINICONDA;
- conda config --set always_yes yes
- conda update conda
- conda info -a
- conda env create -f environment.yml
- source activate dms2dfe

install:
- python setup.py install --record installed_files.txt

script:
- pytest test/test_configure.py
- pytest test/test_datasets.py
after_success:
- coveralls
deploy:
  provider: pypi
  user: rraadd88
  distributions: sdist bdist_wheel
  password:
    secure: BQ9+16p9USy5kIOaweTFzm+rNylxJhIJko0PcB6/VGy8hJlxP2nPc4F2M6rJzP09TvUFHRahShI31v9A0SHi2yGOoebHyTR+9gOvhHsnFm7SgR4AH+CwbCLUfuL5X+VeLtBZlpH8+FJzASppzLWLIPXweLdV8cVXT04HsmuH0ErAlcoeV+mofoMxDH9BOHBfTkZev5lkuGE/jlOM4nBRXok5sNkeqpOcZDsTqOi9c18htL6SMuzkRFR3tFQ2DjFE6XPjqKO4ZC69atNszEaBv0sqYg/VHrsOLOxSsYZHfgNEkWF6X441fy+lnRgXv5E1S2wsno18Nt5qqkqiefYe4mrS5Tk7Nd6qaLHgHGI8rMa/31ci1j52uldY4KtE5ofA5j4ilFtwxSduWg2WmmWlxhYeDcetgqOWYFbBvXXTbda8YVetCF0DaZiuSXt0pgMC21ttYapF8BkfyI/W2Nv8E6ef7akwxLCMfXlHj8uoknrsBBVkE+4NXFxJvvFPl4bgbWofjrZx3HMbOzLaf9uQak0FQJlF80a8nMhb46yiXmJYIEorhLefuBYtoB17piXQ/D2p/INzptIw6yR8I4T/V3m3pp/mSNepKK3MhKfycQdJAtE6y/2N+DpqkFFmcleGfw9+PPzDi81mkRDzXg6O4yXbGMUM7blnpvrHr95n9jQ=
  on:
    tags: true
    branch: master